<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ramadan Relief Fund - Abu Hayyan</title>
    
    <meta property="og:title" content="Ramadan Relief Fund - Managed by Abu Hayyan" />
    <meta property="og:description" content="We are raising funds to support widows and orphans this Ramadan. No amount is too small. Join me in this Sadaqah." />
    <meta property="og:image" content="https://<%= host %>/images/banner.png" /> 
    <meta property="og:url" content="https://<%= host %>" />
    <meta property="og:type" content="website" />

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>

    <nav>
        <div class="nav-inner">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="currentColor" fill-opacity="0.2"/><path d="M13.06 7.28C12.86 6.53 12.47 5.82 11.87 5.22C10.67 4.02 8.8 3.63 7.22 4.17C7.43 5.14 7.87 6.06 8.49 6.83C7.29 7.8 6.55 9.27 6.55 10.91C6.55 13.92 8.99 16.36 12 16.36C13.06 16.36 14.06 16.05 14.91 15.51C15.68 16.13 16.6 16.57 17.57 16.78C18.11 15.2 17.72 13.33 16.52 12.13C15.92 11.53 15.21 11.14 14.46 10.94C14.66 10.18 15.05 9.47 15.65 8.87C14.18 7.4 11.92 7.2 10.27 8.15C11.22 6.5 11.02 4.24 9.55 2.77C8.95 3.37 8.56 4.08 8.36 4.83C8.16 5.58 7.77 6.29 7.17 6.89C8.37 8.09 10.24 8.48 11.82 7.94C11.61 6.97 11.17 6.05 10.55 5.28C11.75 4.31 12.49 2.84 12.49 1.2C12.49 1.07 12.48 0.93 12.47 0.8C13.01 0.91 13.54 1.08 14.05 1.3C15.6 1.98 16.88 3.27 17.56 4.82C18.24 6.37 18.24 8.07 17.56 9.62C16.88 11.17 15.6 12.46 14.05 13.14C12.5 13.82 10.8 13.82 9.25 13.14C7.7 12.46 6.42 11.17 5.74 9.62C5.06 8.07 5.06 6.37 5.74 4.82C6.42 3.27 7.7 1.98 9.25 1.3C9.76 1.08 10.29 0.91 10.83 0.8C10.82 0.93 10.81 1.07 10.81 1.2C10.81 2.84 11.55 4.31 12.75 5.28C12.13 6.05 11.69 6.97 11.48 7.94C13.06 8.48 14.93 8.09 16.13 6.89C15.53 6.29 15.14 5.58 14.94 4.83C14.74 4.08 14.35 3.37 13.75 2.77C12.28 4.24 12.08 6.5 13.03 8.15C11.38 7.2 9.12 7.4 7.65 8.87C8.25 9.47 8.64 10.18 8.84 10.94C9.04 11.69 9.43 12.4 10.03 13C8.83 14.2 6.96 14.59 5.38 14.05C5.59 13.08 6.03 12.16 6.65 11.39C5.45 10.42 4.71 8.95 4.71 7.31C4.71 7.18 4.72 7.04 4.73 6.91C4.19 6.8 3.66 6.63 3.15 6.41C1.6 5.73 0.32 4.44 -0.36 2.89C-1.04 1.34 -1.04 -0.36 -0.36 -1.91C0.32 -3.46 1.6 -4.75 3.15 -5.43C4.7 -6.11 6.4 -6.11 7.95 -5.43C9.5 -4.75 10.78 -3.46 11.46 -1.91C12.14 -0.36 12.14 1.34 11.46 2.89C10.78 4.44 9.5 5.73 7.95 6.41C7.44 6.63 6.91 6.8 6.37 6.91C6.38 7.04 6.39 7.18 6.39 7.31C6.39 8.95 5.65 10.42 4.45 11.39C5.07 12.16 5.51 13.08 5.72 14.05C4.14 14.59 2.27 14.2 1.07 13C1.67 12.4 2.06 11.69 2.26 10.94C2.46 10.19 2.85 9.48 3.45 8.88C2.85 8.28 2.46 7.57 2.26 6.82C2.06 6.07 1.67 5.36 1.07 4.76C2.27 3.56 4.14 3.17 5.72 3.71C5.51 4.68 5.07 5.6 4.45 6.37C5.65 7.34 6.39 8.81 6.39 10.45C6.39 10.58 6.38 10.72 6.37 10.85C5.83 10.74 5.3 10.57 4.79 10.35C3.24 9.67 1.96 8.38 1.28 6.83C0.6 5.28 0.6 3.58 1.28 2.03C1.96 0.48 3.24 -0.81 4.79 -1.49C6.34 -2.17 8.04 -2.17 9.59 -1.49C11.14 -0.81 12.42 0.48 13.1 2.03C13.78 3.58 13.78 5.28 13.1 6.83C12.42 8.38 11.14 9.67 9.59 10.35C9.08 10.57 8.55 10.74 8.01 10.85C8 10.72 7.99 10.58 7.99 10.45C7.99 8.81 8.73 7.34 9.93 6.37C9.31 5.6 8.87 4.68 8.66 3.71C10.24 3.17 12.11 3.56 13.31 4.76Z" fill="currentColor"/></svg>
            <span>Ramadan Relief Fund</span>
        </div>
    </nav>

    <div class="container">
        <div class="hero-wrapper">
            <img src="/images/banner.png" class="hero-img" alt="Ramadan Relief" onerror="this.src='https://images.unsplash.com/photo-1593113616825-d66722e28ee9?w=1000&q=80'">
        </div>

        <div class="content">
            <div class="stats-card">
                <div class="amt-row">
                    <span class="big-amt live-amt">‚Ç¶<%= raised.toLocaleString() %></span>
                    <span class="goal">raised of ‚Ç¶<%= goal.toLocaleString() %> goal</span>
                </div>
                
                <div class="progress-bg">
                    <div class="progress-fill live-bar" style="width: <%= (raised / goal) * 100 %>%"></div>
                </div>

                <div class="share-grid">
                    <a href="https://wa.me/?text=Let's%20support%20the%20Ramadan%20Relief%20Fund%20by%20Abu%20Hayyan%20to%20feed%20the%20needy.%20Every%20Naira%20counts.%20Donate%20securely%20here:%20https://<%= host %>" target="_blank" class="btn-share btn-whatsapp">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592z"/></svg>
                        Share to WhatsApp
                    </a>
                    <a href="https://wa.me/?text=Assalamualaikum.%20I%20am%20supporting%20this%20Ramadan%20Relief%20Fund%20managed%20by%20Abu%20Hayyan.%20Please%20join%20me.%20https://<%= host %>" target="_blank" class="btn-share btn-status">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.646 5.646L7 10.293 4.354 7.646a.5.5 0 1 1 .708-.708l2 2 4-4a.5.5 0 0 1 .708.708z"/></svg>
                        Add to Status
                    </a>
                </div>
            </div>

            <div class="campaign-story">
                <p><strong>Bismillah.</strong></p>
                <p>For those who knew me last Ramadan, you may remember that we raised a certain amount to support many people. AlhamdulillƒÅh, Allah used it as a means (sabab) to ease the affairs of some individuals.</p>
                <p>This year, Ramadan is approaching again, and I hope we can once more put smiles on a few faces; among them <strong>widows, orphans, debtors, and people who are genuinely struggling to survive.</strong></p>
                
                <blockquote>"Do we have a fixed target? Not exactly. However, a minimum of ‚Ç¶1,000,000 will go a long way."</blockquote>

                <p>This is my personal way of supporting the less privileged. I‚Äôm not interested in posting on Facebook, as it is already crowded with fundraisers. This appeal is shared primarily via my WhatsApp status.</p>
                
                <p><strong>No amount is too small.</strong> Whether it‚Äôs ‚Ç¶100, ‚Ç¶500, or ‚Ç¶1,000 daily before or during Ramadan, it counts and will make a difference.</p>
                
                <p>I will also reach out to some people offline and online, in shƒÅ‚Äô AllƒÅh. Can you do that too? So let us begin.</p>
                
                <p class="signature">
                    ‚Äî Managed by Abu Hayyan
                </p>
            </div>

            <div class="feed-container">
                <div class="feed-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor"/></svg>
                    Recent Contributions (<span id="count"><%= donations.length %></span>)
                </div>
                <div id="donationFeed">
                    <% donations.forEach(function(d) { %>
                        <div class="donation-item">
                            <div class="d-icon-box">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                            </div>
                            <div class="d-info">
                                <span class="d-name"><%= d.donorName %></span>
                                <div class="d-meta">Donated <span class="d-amount">‚Ç¶<%= d.amount.toLocaleString() %></span></div>
                                <% if(d.comment) { %> 
                                    <div class="d-comment-text">"<%= d.comment %>"</div> 
                                <% } %>
                            </div>
                        </div>
                    <% }); %>
                </div>
            </div>

        </div>
    </div>

    <div class="sticky-footer">
        <div class="footer-inner">
            <div class="footer-info">
                Raised: <span class="live-amt" style="color:var(--primary)">‚Ç¶<%= raised.toLocaleString() %></span>
            </div>
            <button onclick="openModal()" class="btn-donate-sticky">Donate Now</button>
        </div>
    </div>

    <div id="modal" class="modal-overlay">
        <div class="modal-box">
            
            <div id="donation-form">
                <div class="modal-header">
                    <h3 class="modal-title">Make a Contribution</h3>
                    <span onclick="closeModal()" class="close-btn">&times;</span>
                </div>

                <div class="preset-grid">
                    <div class="btn-preset" onclick="setPreset(1000, this)">‚Ç¶1,000</div>
                    <div class="btn-preset" onclick="setPreset(2000, this)">‚Ç¶2,000</div>
                    <div class="btn-preset" onclick="setPreset(5000, this)">‚Ç¶5,000</div>
                    <div class="btn-preset" onclick="setPreset(10000, this)">‚Ç¶10,000</div>
                </div>

                <div class="inp-group">
                    <input type="text" inputmode="numeric" pattern="[0-9]*" id="amt" class="inp" placeholder="Other amount (‚Ç¶)" required>
                </div>
                <div class="inp-group">
                    <input type="email" id="email" class="inp" placeholder="Email Address (Required)" required>
                </div>
                <div class="inp-group">
                    <input type="text" id="name" class="inp" placeholder="Your Name (Optional)">
                </div>
                <div class="inp-group">
                    <input type="text" id="comment" class="inp" placeholder="Leave a prayer (Optional)">
                </div>

                <button onclick="pay()" class="btn-pay">DONATE NOW</button>
                
                <div class="modal-trust-footer">
                    <p>Managed by Abu Hayyan. 100% of funds go to beneficiaries.</p>
                    <div class="trust-badge">
                        <svg width="12" height="12" fill="currentColor" viewBox="0 0 16 16"><path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/></svg>
                        Secure payment via Paystack
                    </div>
                </div>
            </div>

            <div id="success-message">
                <div class="success-icon">üéâ</div>
                <h3 class="success-title">JazaakAllahu Khairan!</h3>
                <p class="success-desc">May Allah accept your sadaqah, purify your wealth, and grant you ease in this life and the hereafter.</p>
                <div class="managed-badge">
                    <p class="managed-text">Managed by Abu Hayyan</p>
                </div>
                <button onclick="closeModal()" class="btn-preset" style="margin-top:20px; width:100%; background:var(--bg-gray);">Close Window</button>
            </div>

        </div>
    </div>

    <script>
        const publicKey = "<%= publicKey %>";
        const socket = io();

        function openModal() { 
            document.getElementById('modal').style.display = 'flex'; 
            document.getElementById('donation-form').style.display = 'block';
            document.getElementById('success-message').style.display = 'none';
        }
        function closeModal() { document.getElementById('modal').style.display = 'none'; }
        
        function setPreset(amount, btn) {
            document.getElementById('amt').value = amount;
            document.querySelectorAll('.btn-preset').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        socket.on('new_donation', (data) => {
            document.querySelectorAll('.live-amt').forEach(el => el.innerText = "‚Ç¶" + data.totalRaised.toLocaleString());
            document.querySelectorAll('.live-bar').forEach(el => el.style.width = ((data.totalRaised / <%= goal %>) * 100) + "%");
            
            const count = document.getElementById('count');
            count.innerText = parseInt(count.innerText) + 1;

            const feed = document.getElementById('donationFeed');
            const item = `
                <div class="donation-item" style="background-color: var(--primary-light); border-radius:12px; padding: 15px;">
                    <div class="d-icon-box" style="background:white;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                    </div>
                    <div class="d-info">
                        <span class="d-name">${data.donorName}</span>
                        <div class="d-meta">Just now <span class="d-amount">‚Ç¶${data.amount.toLocaleString()}</span></div>
                        ${data.comment ? `<div class="d-comment-text" style="background:white;">"${data.comment}"</div>` : ''}
                    </div>
                </div>`;
            feed.insertAdjacentHTML('afterbegin', item);
        });

        async function pay() {
            const amount = document.getElementById('amt').value;
            const email = document.getElementById('email').value;
            const name = document.getElementById('name').value;
            const comment = document.getElementById('comment').value;

            if(!amount || !email) return alert("Please enter Amount and Email");

            try {
                const res = await fetch('/donate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ amount, email, name, comment })
                });
                const data = await res.json();

                const handler = PaystackPop.setup({
                    key: publicKey,
                    email: email,
                    amount: amount * 100,
                    ref: data.reference,
                    callback: function() {
                        document.getElementById('donation-form').style.display = 'none';
                        document.getElementById('success-message').style.display = 'block';
                    }
                });
                handler.openIframe();
            } catch(e) {
                alert("Error processing request. Please try again.");
            }
        }
    </script> 

    <script>
        // DISABLE RIGHT CLICK
        document.addEventListener('contextmenu', event => event.preventDefault());

        // DISABLE KEYBOARD SHORTCUTS
        document.onkeydown = function(e) {
            if (e.keyCode == 123) { return false; } 
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) { return false; }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) { return false; } 
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) { return false; } 
        }
    </script>
</body>
</html>
